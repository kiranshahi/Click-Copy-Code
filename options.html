<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Click Copy Options</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        #customColors { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Notification Theme</h1>
    <label><input type="radio" name="scheme" value="light"> Light</label><br>
    <label><input type="radio" name="scheme" value="dark"> Dark</label><br>
    <label><input type="radio" name="scheme" value="custom"> Custom</label>
    <div id="customColors" style="display:none;">
        <label>Background: <input type="color" id="bgColor" value="#6002ee"></label>
        <label>Text: <input type="color" id="textColor" value="#f5f5f5"></label>
    </div>
    <div style="margin-top:10px;">
        <button id="save">Save</button>
    </div>
    <div id="status" style="margin-top:10px;color:green;"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const schemeRadios = document.querySelectorAll('input[name="scheme"]');
            const customColors = document.getElementById('customColors');
            const bgColor = document.getElementById('bgColor');
            const textColor = document.getElementById('textColor');
            const status = document.getElementById('status');

            function load() {
                const fallback = {scheme: 'light', bgColor: '#6002ee', textColor: '#f5f5f5'};
                if (chrome.storage && chrome.storage.local) {
                    chrome.storage.local.get(['theme'], function (res) {
                        const theme = res.theme || fallback;
                        setValues(theme);
                    });
                } else {
                    const theme = JSON.parse(localStorage.getItem('theme')) || fallback;
                    setValues(theme);
                }
            }

            function setValues(theme) {
                document.querySelector(`input[value="${theme.scheme}"]`).checked = true;
                if (theme.scheme === 'custom') {
                    customColors.style.display = 'block';
                    bgColor.value = theme.bgColor || '#6002ee';
                    textColor.value = theme.textColor || '#f5f5f5';
                }
            }

            schemeRadios.forEach(r => {
                r.addEventListener('change', function () {
                    customColors.style.display = this.value === 'custom' ? 'block' : 'none';
                });
            });

            document.getElementById('save').addEventListener('click', function () {
                const scheme = document.querySelector('input[name="scheme"]:checked').value;
                const theme = {scheme};
                if (scheme === 'custom') {
                    theme.bgColor = bgColor.value;
                    theme.textColor = textColor.value;
                }
                if (chrome.storage && chrome.storage.local) {
                    chrome.storage.local.set({theme}, function () {
                        status.textContent = 'Saved!';
                        setTimeout(()=>status.textContent='', 1000);
                    });
                } else {
                    localStorage.setItem('theme', JSON.stringify(theme));
                    status.textContent = 'Saved!';
                    setTimeout(()=>status.textContent='', 1000);
                }
            });

            load();
        });
    </script>
</body>
</html>
